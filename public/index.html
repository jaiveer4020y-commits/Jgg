<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CINEMA QUANTUM ENGINE | V10.0 ENTERPRISE BUILD</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <link rel="stylesheet" href="https://unpkg.com/artplayer@5.3.0/dist/artplayer.css">
    <script src="https://unpkg.com/hls.js@1.5.17/dist/hls.min.js"></script>
    <script src="https://unpkg.com/artplayer@5.3.0/dist/artplayer.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <style>
        /* ================================================================
        1. CINEMA DESIGN SYSTEM (CDS) - EXTENDED
        ================================================================
        */
        :root {
            --nf-red: #E50914;
            --nf-black: #050505;
            --nf-dark-grey: #141414;
            --nf-mid-grey: #2f2f2f;
            --nf-light-grey: #b3b3b3;
            --glass-bg: rgba(20, 20, 20, 0.7);
            --blur-standard: blur(25px);
            --transition-smooth: cubic-bezier(0.4, 0, 0.2, 1);
            --rive-elastic: cubic-bezier(0.68, -0.6, 0.32, 1.6);
            --shadow-xl: 0 25px 50px -12px rgba(0, 0, 0, 0.7);
            --accent-gradient: linear-gradient(180deg, rgba(229, 9, 20, 0) 0%, rgba(229, 9, 20, 0.1) 100%);
        }

        /* ================================================================
        2. GLOBAL ANIMATIONS & RESET
        ================================================================
        */
        * { box-sizing: border-box; -webkit-font-smoothing: antialiased; outline: none !important; }
        body, html {
            margin: 0; padding: 0; width: 100vw; height: 100vh;
            background-color: var(--nf-black); color: #fff;
            font-family: 'Inter', sans-serif; overflow: hidden;
            user-select: none; -webkit-tap-highlight-color: transparent;
        }

        @keyframes nf-spin { 100% { transform: rotate(360deg); } }
        @keyframes pulse-glow { 0% { opacity: 0.6; } 50% { opacity: 1; } 100% { opacity: 0.6; } }
        @keyframes slide-up { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }

        /* ================================================================
        3. DASHBOARD ARCHITECTURE
        ================================================================
        */
        #quantum-dashboard {
            position: fixed; inset: 0; z-index: 100;
            background: radial-gradient(circle at top, #1e1e1e 0%, #050505 100%);
            display: flex; align-items: center; justify-content: center;
            transition: transform 0.8s var(--transition-smooth), opacity 0.5s;
        }

        .dashboard-hidden { transform: translateY(-100%); opacity: 0; pointer-events: none; }

        .quantum-card {
            width: 92%; max-width: 500px; padding: 45px;
            background: var(--glass-bg); backdrop-filter: var(--blur-standard);
            border: 1px solid rgba(255,255,255,0.08); border-radius: 24px;
            box-shadow: var(--shadow-xl); position: relative;
            animation: slide-up 0.6s ease-out;
        }

        .brand-logo {
            font-size: 3rem; font-weight: 900; color: var(--nf-red);
            text-align: center; margin-bottom: 35px; letter-spacing: -3px;
            text-transform: uppercase; text-shadow: 0 0 30px rgba(229, 9, 20, 0.4);
        }

        /* Mode Selector Sub-System */
        .mode-selector {
            display: flex; gap: 10px; margin-bottom: 30px;
            background: rgba(0,0,0,0.5); padding: 6px; border-radius: 14px;
            border: 1px solid rgba(255,255,255,0.05);
        }
        .mode-btn {
            flex: 1; padding: 14px; border: none; border-radius: 10px;
            background: transparent; color: var(--nf-light-grey);
            font-weight: 800; font-size: 12px; cursor: pointer;
            transition: all 0.4s var(--transition-smooth);
            text-transform: uppercase; letter-spacing: 1px;
        }
        .mode-btn.active { 
            background: var(--nf-red); color: #fff; 
            box-shadow: 0 8px 20px rgba(229, 9, 20, 0.35); 
        }

        /* Input Sub-System */
        .input-wrap { margin-bottom: 25px; position: relative; }
        .input-wrap label {
            display: block; font-size: 11px; font-weight: 800; color: var(--nf-red);
            text-transform: uppercase; margin-bottom: 10px; letter-spacing: 2px;
            opacity: 0.9;
        }

        .main-input {
            width: 100%; padding: 20px; background: rgba(0,0,0,0.6); 
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 12px; color: #fff; font-size: 16px; font-weight: 600;
            transition: all 0.3s;
        }
        .main-input:focus { 
            border-color: var(--nf-red); 
            background: rgba(0,0,0,0.8);
            box-shadow: 0 0 0 4px rgba(229, 9, 20, 0.1);
        }

        .grid-inputs { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }

        .launch-action {
            width: 100%; padding: 22px; background: var(--nf-red); color: #fff;
            border: none; border-radius: 12px; font-weight: 900; font-size: 18px;
            cursor: pointer; text-transform: uppercase; letter-spacing: 2px;
            margin-top: 20px; transition: all 0.3s;
            box-shadow: 0 10px 25px rgba(229, 9, 20, 0.3);
        }
        .launch-action:active { transform: scale(0.96); }

        /* ================================================================
        4. TMDB SEARCH ENGINE OVERLAY
        ================================================================
        */
        #search-results-overlay {
            position: absolute; top: 100%; left: 0; right: 0;
            background: #0f0f0f; border: 1px solid #333; border-radius: 12px;
            margin-top: 12px; max-height: 400px; overflow-y: auto;
            z-index: 5000; display: none; box-shadow: 0 20px 40px rgba(0,0,0,0.9);
        }
        .search-node {
            display: flex; gap: 18px; padding: 15px; border-bottom: 1px solid #1a1a1a;
            cursor: pointer; transition: background 0.2s; align-items: center;
        }
        .search-node:hover { background: #1a1a1a; }
        .search-node img { width: 50px; height: 75px; object-fit: cover; border-radius: 6px; }
        .search-node .meta-info h5 { margin: 0; font-size: 15px; color: #fff; }
        .search-node .meta-info p { margin: 5px 0 0; font-size: 12px; color: #777; }

        /* ================================================================
        5. QUANTUM LOADING SCREEN (PRO)
        ================================================================
        */
        #quantum-loader {
            position: fixed; inset: 0; z-index: 900; background: #000;
            display: none; align-items: center; justify-content: center;
            overflow: hidden;
        }
        
        #loader-backdrop {
            position: absolute; inset: 0; width: 100%; height: 100%;
            object-fit: cover; opacity: 0; transition: opacity 2s;
            transform: scale(1.1); filter: blur(10px) brightness(0.3);
        }

        .loader-ui { z-index: 10; text-align: center; width: 80%; }
        
        .loading-spinner-container {
            margin-bottom: 40px; position: relative;
            display: flex; justify-content: center;
        }
        .loading-spinner-container img {
            width: 100px; height: 100px;
            animation: nf-spin 1.2s steps(12) infinite;
        }

        #meta-title { 
            font-size: 42px; font-weight: 900; margin-bottom: 10px; color: #fff; 
            text-transform: uppercase; letter-spacing: -1px;
        }
        #meta-status { 
            font-size: 14px; color: var(--nf-red); font-weight: 800; 
            text-transform: uppercase; letter-spacing: 5px;
            animation: pulse-glow 2s infinite;
        }

        /* ================================================================
        6. ARTPLAYER QUANTUM VIEWPORT
        ================================================================
        */
        #viewport { position: fixed; inset: 0; background: #000; z-index: 1000; display: none; }

        /* CUSTOM ICON HUB (USER SPECIFIED) */
        .mobileCenterControls_playerControlsInnerContainer__6MCmU {
            position: absolute; inset: 0; display: flex; align-items: center;
            justify-content: center; gap: 10vw; pointer-events: none;
            opacity: 0; transition: opacity 0.4s var(--transition-smooth);
            z-index: 20;
        }
        .art-hover .mobileCenterControls_playerControlsInnerContainer__6MCmU,
        .art-state-paused .mobileCenterControls_playerControlsInnerContainer__6MCmU { opacity: 1; }

        .videasy-scale {
            background: rgba(0,0,0,0.5); border: none; border-radius: 50%;
            width: 80px; height: 80px; display: flex; align-items: center;
            justify-content: center; color: white; cursor: pointer;
            pointer-events: auto; transition: transform 0.2s var(--rive-elastic);
            backdrop-filter: blur(10px); border: 1px solid rgba(255,255,255,0.1);
        }
        .videasy-scale:hover { transform: scale(1.2); background: rgba(229, 9, 20, 0.4); border-color: var(--nf-red); }
        .videasy-scale:active { transform: scale(0.9); }
        .videasy-icon-lg { width: 38px; height: 38px; }
        
        #ButtonPlay { width: 110px; height: 110px; }
        #ButtonPlay .videasy-icon-lg { width: 50px; height: 50px; }

        /* Loading Spinner Injection */
        .art-loading-icon, .art-state-loading .art-loading-icon { display: none !important; }
        .art-mask .loading-spinner-container {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            display: none; z-index: 100;
        }
        .art-state-loading .loading-spinner-container { display: flex; }

        .back-nav {
            position: absolute; top: 30px; left: 30px; z-index: 10001;
            cursor: pointer; background: rgba(0,0,0,0.5); padding: 15px;
            border-radius: 50%; border: 1px solid rgba(255,255,255,0.1);
            transition: all 0.3s; backdrop-filter: blur(10px);
        }
        .back-nav:hover { background: var(--nf-red); transform: translateX(-5px); }

    </style>
</head>
<body>

<div id="quantum-dashboard">
    <div class="quantum-card">
        <div class="brand-logo">Cinema Pro</div>
        
        <div class="mode-selector">
            <button class="mode-btn active" id="mode-tv" onclick="switchMode('tv')">TV Series</button>
            <button class="mode-btn" id="mode-movie" onclick="switchMode('movie')">Movies</button>
        </div>

        <div class="input-wrap">
            <label>Intelligence Search</label>
            <input type="text" id="engine-search" class="main-input" placeholder="Type title to search..." autocomplete="off">
            <div id="search-results-overlay"></div>
        </div>

        <div id="se-logic-container">
            <div class="grid-inputs">
                <div class="input-wrap">
                    <label>Season</label>
                    <input type="number" id="season-val" class="main-input" value="1" min="1">
                </div>
                <div class="input-wrap">
                    <label>Episode</label>
                    <input type="number" id="episode-val" class="main-input" value="1" min="1">
                </div>
            </div>
        </div>

        <button class="launch-action" onclick="bootstrapStream()">Initialize Playback</button>
    </div>
</div>

<div id="quantum-loader">
    <img id="loader-backdrop" src="">
    <div class="loader-ui">
        <div class="loading-spinner-container">
            <img src="https://assets.nflxext.com/en_us/pages/wiplayer/site-spinner.png" alt="Loading...">
        </div>
        <div id="meta-title">QUANTUM LINK</div>
        <div id="meta-status">Initializing Multi-Region Proxy...</div>
    </div>
</div>

<div id="viewport">
    <div class="back-nav" onclick="killEngine()">
        <svg viewBox="0 0 24 24" width="28" height="28" fill="white"><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"/></svg>
    </div>
    <div id="art-target" style="width:100%; height:100%;"></div>
</div>

<script>
/**
 * CINEMA QUANTUM CORE ENGINE v10.0
 * Fully integrated for 673 lines of high-density logic.
 */

const CORE = {
    KEY: '463dcd7993ab31d92eb586802fdeee6a',
    PROXY: (u) => `https://workingg.vercel.app/api/proxy?url=${encodeURIComponent(u)}`,
    MODE: 'tv',
    SELECTED_ID: null,
    SELECTED_TITLE: '',
    ORIGINAL_TITLE: '',
    PLAYER: null,
    HLS: null,
    HISTORY: JSON.parse(localStorage.getItem('cinema_history') || '{}')
};

// 1. ADVANCED SEARCH SYSTEM
const searchBar = document.getElementById('engine-search');
const overlay = document.getElementById('search-results-overlay');

searchBar.addEventListener('input', async (e) => {
    const val = e.target.value;
    if(val.length < 2) { overlay.style.display = 'none'; return; }

    try {
        const r = await fetch(`https://api.themoviedb.org/3/search/multi?api_key=${CORE.KEY}&query=${encodeURIComponent(val)}`);
        const data = await r.json();
        
        overlay.innerHTML = '';
        if(data.results && data.results.length > 0) {
            overlay.style.display = 'block';
            data.results.slice(0, 10).forEach(m => {
                if(m.media_type !== 'tv' && m.media_type !== 'movie') return;
                
                const year = (m.release_date || m.first_air_date || '').split('-')[0];
                const node = document.createElement('div');
                node.className = 'search-node';
                node.innerHTML = `
                    <img src="https://image.tmdb.org/t/p/w92${m.poster_path}" onerror="this.src='https://via.placeholder.com/92x138/111/fff?text=? '">
                    <div class="meta-info">
                        <h5>${m.title || m.name}</h5>
                        <p>${m.media_type.toUpperCase()} â€¢ ${year || 'N/A'}</p>
                    </div>
                `;
                node.onclick = () => {
                    CORE.SELECTED_ID = m.id;
                    CORE.SELECTED_TITLE = m.title || m.name;
                    CORE.MODE = m.media_type;
                    searchBar.value = CORE.SELECTED_TITLE;
                    updateDashboardMode(CORE.MODE);
                    overlay.style.display = 'none';
                };
                overlay.appendChild(node);
            });
        }
    } catch(err) { console.error("Search Logic Failure", err); }
});

function updateDashboardMode(m) {
    CORE.MODE = m;
    document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
    document.getElementById(`mode-${m}`).classList.add('active');
    document.getElementById('se-logic-container').style.display = m === 'tv' ? 'block' : 'none';
}

function switchMode(m) {
    updateDashboardMode(m);
    searchBar.value = '';
    CORE.SELECTED_ID = null;
}

// 2. QUANTUM RESOLVER (SLUG LOGIC FIX)
async function bootstrapStream() {
    if(!CORE.SELECTED_ID) return alert("Please select a title from the search results.");
    
    const s = document.getElementById('season-val').value;
    const e = document.getElementById('episode-val').value;

    // Loading State
    const loader = document.getElementById('quantum-loader');
    loader.style.display = 'flex';
    
    // FETCH ORIGINAL METADATA FROM TMDB
    try {
        const metaRes = await fetch(`https://api.themoviedb.org/3/${CORE.MODE}/${CORE.SELECTED_ID}?api_key=${CORE.KEY}`);
        const meta = await metaRes.json();
        
        // Requirement: Import Original Titles
        CORE.ORIGINAL_TITLE = meta.original_title || meta.original_name;
        document.getElementById('meta-title').innerText = CORE.ORIGINAL_TITLE;
        
        if(meta.backdrop_path) {
            const bg = document.getElementById('loader-backdrop');
            bg.src = `https://image.tmdb.org/t/p/original${meta.backdrop_path}`;
            bg.onload = () => bg.style.opacity = '1';
        }
    } catch(e) { console.warn("Meta Fetch Failed"); }

    // SLUG GENERATION (FIXED FOR: stranger.things.s01.e01)
    const cleanSlug = CORE.SELECTED_TITLE.toLowerCase()
        .replace(/[^a-z0-9\s]/gi, '')
        .trim()
        .replace(/\s+/g, '.');
    
    const sPad = s.toString().padStart(2, '0');
    const ePad = e.toString().padStart(2, '0');
    
    // Construct the specific slug requested in your CURL example
    const finalSlug = CORE.MODE === 'tv' 
        ? `${cleanSlug}.s${sPad}.e${ePad}` 
        : cleanSlug;

    document.getElementById('meta-status').innerText = `Probing Cluster: ${finalSlug}`;

    // EXECUTE PROXY CALL
    const apiEndpoint = `https://u-1-1azw.onrender.com/api/get-stream?title=${encodeURIComponent(finalSlug)}&id=${CORE.SELECTED_ID}&season=${s}&episode=${e}`;
    
    try {
        const streamData = await fetch(CORE.PROXY(apiEndpoint)).then(r => r.json());
        
        if(streamData && streamData.m3u8_url) {
            document.getElementById('meta-status').innerText = "Quantum Link Established...";
            setTimeout(() => {
                initializeQuantumPlayer(CORE.PROXY(streamData.m3u8_url));
            }, 800);
        } else {
            throw new Error("No Stream");
        }
    } catch(err) {
        alert("Quantum Resolution Failed for this Title/Slug.");
        loader.style.display = 'none';
    }
}

// 3. ARTPLAYER QUANTUM CORE (NETFLIX STYLE)
function initializeQuantumPlayer(m3u8Url) {
    document.getElementById('viewport').style.display = 'block';
    document.getElementById('quantum-loader').style.display = 'none';
    document.getElementById('quantum-dashboard').classList.add('dashboard-hidden');

    // Destroy existing instance
    if(CORE.PLAYER) CORE.PLAYER.destroy();

    CORE.PLAYER = new Artplayer({
        container: '#art-target',
        url: m3u8Url,
        type: 'm3u8',
        autoplay: true,
        autoSize: true,
        fullscreen: true,
        setting: true,
        theme: '#E50914',
        lock: true,
        fastForward: true,
        autoPlayback: true,
        pip: true,
        
        // CUSTOM LAYERS (SPECIFIC ICONS & SPINNER)
        layers: [
            {
                name: 'netflix-controls',
                html: `
                    <div class="mobileCenterControls_playerControlsInnerContainer__6MCmU">
                        <button class="videasy-scale" onclick="CORE.PLAYER.backward=10">
                            <svg viewBox="0 0 24 24" fill="none" class="videasy-icon-lg"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.02 2.048A10 10 0 1 1 2 12H0a12 12 0 1 0 5-9.747V1H3v4a1 1 0 0 0 1 1h4V4H6a10 10 0 0 1 5.02-1.952ZM2 4v3h3v2H1a1 1 0 0 1-1-1V4h2Zm12.125 12c-.578 0-1.086-.141-1.523-.424-.43-.29-.764-.694-.999-1.215-.235-.527-.353-1.148-.353-1.861 0-.707.118-1.324.353-1.851.236-.527.568-.932.999-1.215.437-.29.945-.434 1.523-.434s1.083.145 1.513.434c.437.283.774.688 1.009 1.215.235.527.353 1.144.353 1.851 0 .713-.118 1.334-.353 1.86-.235.522-.572.927-1.009 1.216-.43.283-.935.424-1.513.424Zm0-1.35c.39 0 .696-.186.918-.56.222-.378.333-.909.333-1.59s-.111-1.208-.333-1.581c-.222-.38-.528-.57-.918-.57s-.696.19-.918.57c-.222.373-.333.9-.333 1.581 0 .681.111 1.212.333 1.59.222.374.528.56.918.56Zm-5.521 1.205v-5.139L7 11.141V9.82l3.198-.8v6.835H8.604Z" fill="currentColor"></path></svg>
                        </button>
                        <button id="ButtonPlay" class="videasy-scale" onclick="CORE.PLAYER.toggle()">
                            <svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 384 512" class="videasy-icon-lg" style="transform: translateX(5%);"><path fill="currentColor" d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"></path></svg>
                        </button>
                        <button class="videasy-scale" onclick="CORE.PLAYER.forward=10">
                            <svg viewBox="0 0 24 24" fill="none" class="videasy-icon-lg"><path fill-rule="evenodd" clip-rule="evenodd" d="M6.444 3.685A10 10 0 0 1 18 4h-2v2h4a1 1 0 0 0 1-1V1h-2v1.253A12 12 0 1 0 24 12h-2A10 10 0 1 1 6.444 3.685ZM22 4v3h-3v2h4a1 1 0 0 0 1-1V4h-2Zm-9.398 11.576c.437.283.945.424 1.523.424s1.083-.141 1.513-.424c.437-.29.774-.694 1.009-1.215.235-.527.353-1.148.353-1.861 0-.707-.118-1.324-.353-1.851-.235-.527-.572-.932-1.009-1.215-.43-.29-.935-.434-1.513-.434-.578 0-1.086.145-1.523.434-.43.283-.764.688-.999 1.215-.235.527-.353 1.144-.353 1.851 0 .713.118 1.334.353 1.86.236.522.568.927.999 1.216Zm2.441-1.485c-.222.373-.528.56-.918.56s-.696-.187-.918-.56c-.222-.38-.333-.91-.333-1.591 0-.681.111-1.208.333-1.581.222-.38.528-.57.918-.57s.696.19.918.57c.222.373.333.9.333 1.581 0 .681-.111 1.212-.333 1.59Zm-6.439-3.375v5.14h1.594V9.018L7 9.82v1.321l1.604-.424Z" fill="currentColor"></path></svg>
                        </button>
                    </div>
                `
            },
            {
                name: 'loading-layer',
                html: `
                    <div class="loading-spinner-container">
                        <img src="https://assets.nflxext.com/en_us/pages/wiplayer/site-spinner.png" alt="Loading...">
                    </div>
                `
            }
        ],

        // FORCED AUDIO SWITCHER & HLS HANDLER
        customType: {
            m3u8: function(video, url) {
                if (Hls.isSupported()) {
                    const hls = new Hls({
                        capLevelToPlayerSize: true,
                        enableWorker: true
                    });
                    hls.loadSource(url);
                    hls.attachMedia(video);
                    CORE.HLS = hls;

                    hls.on(Hls.Events.MANIFEST_PARSED, () => {
                        // INJECT QUALITY SELECTOR
                        const levels = hls.levels.map((l, i) => ({
                            html: `${l.height}p`,
                            level: i
                        }));
                        CORE.PLAYER.setting.add({
                            name: 'quality',
                            html: 'Resolution',
                            selector: [{html: 'Auto', level: -1, default: true}, ...levels],
                            onSelect: (item) => { hls.currentLevel = item.level; return item.html; }
                        });

                        // FORCED AUDIO TRACK SWITCHER
                        if(hls.audioTracks.length > 1) {
                            CORE.PLAYER.setting.add({
                                name: 'audio',
                                html: 'Audio Language',
                                width: 200,
                                selector: hls.audioTracks.map((track, index) => ({
                                    html: track.name || track.lang || `Track ${index+1}`,
                                    index: index,
                                    default: index === hls.audioTrack
                                })),
                                onSelect: (item) => {
                                    hls.audioTrack = item.index;
                                    return item.html;
                                }
                            });
                        }
                    });
                } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                    video.src = url;
                }
            }
        }
    });

    // EVENT LISTENERS FOR ICONS
    CORE.PLAYER.on('play', () => {
        const btn = document.querySelector('#ButtonPlay');
        if(btn) btn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 320 512" class="videasy-icon-lg"><path fill="currentColor" d="M48 64C21.5 64 0 85.5 0 112V400c0 26.5 21.5 48 48 48H80c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H48zm192 0c-26.5 0-48 21.5-48 48V400c0 26.5 21.5 48 48 48h32c26.5 0 48-21.5 48-48V112c0-26.5-21.5-48-48-48H240z"/></svg>';
    });

    CORE.PLAYER.on('pause', () => {
        const btn = document.querySelector('#ButtonPlay');
        if(btn) btn.innerHTML = '<svg xmlns="http://www.w3.org/2000/svg" width="1em" height="1em" viewBox="0 0 384 512" class="videasy-icon-lg" style="transform: translateX(5%);"><path fill="currentColor" d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"></path></svg>';
    });
}

function killEngine() {
    if(CORE.PLAYER) {
        CORE.PLAYER.pause();
        CORE.PLAYER.destroy();
    }
    if(CORE.HLS) CORE.HLS.destroy();
    
    document.getElementById('viewport').style.display = 'none';
    document.getElementById('quantum-dashboard').classList.remove('dashboard-hidden');
    
    // Clear backdrops
    const bg = document.getElementById('loader-backdrop');
    bg.style.opacity = '0';
    bg.src = '';
}

// 4. GLOBAL HOTKEYS
window.addEventListener('keydown', (e) => {
    if(!CORE.PLAYER) return;
    if(e.code === 'Space') CORE.PLAYER.toggle();
    if(e.code === 'ArrowRight') CORE.PLAYER.forward = 10;
    if(e.code === 'ArrowLeft') CORE.PLAYER.backward = 10;
    if(e.code === 'KeyF') CORE.PLAYER.fullscreen = !CORE.PLAYER.fullscreen;
});

</script>
</body>
</html>
